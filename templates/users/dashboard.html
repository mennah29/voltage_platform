{% extends 'base.html' %}
{% load static %}

{% block title %}Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…{% endblock %}

{% block content %}
<div class="container" style="padding: 40px 0;">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
        <div class="user-info">
            {% if user.profile_pic %}
            <img src="{{ user.profile_pic.url }}" alt="ØµÙˆØ±ØªÙŠ" class="user-avatar">
            {% else %}
            <div class="user-avatar"
                style="background: var(--accent-cyan); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: var(--primary-dark);">
                {{ user.first_name|slice:":1" }}
            </div>
            {% endif %}
            <div>
                <p class="user-name">Ø£Ù‡Ù„Ø§Ù‹ØŒ {{ user.first_name }}! ğŸ‘‹</p>
                <p style="color: var(--text-muted);">{{ user.get_grade_display }}</p>
            </div>
        </div>

        <!-- Battery Indicator -->
        <div class="battery">
            <span class="battery-icon">ğŸ”‹</span>
            <div class="battery-bar">
                <div class="battery-level" data-level="{{ user.battery_level }}"
                    style="width: {{ user.battery_level }}%;"></div>
            </div>
            <span class="battery-text">{{ user.battery_level }}%</span>
        </div>
    </div>

    <!-- Quick Actions -->
    <div style="display: flex; gap: 15px; margin-bottom: 40px; flex-wrap: wrap;">
        <a href="{% url 'users:activate_code' %}" class="btn btn-primary">
            ğŸ”‘ ØªÙØ¹ÙŠÙ„ ÙƒÙˆØ¯
        </a>
        <a href="{% url 'courses:chapter_list' %}?grade={{ user.grade }}" class="btn btn-outline">
            ğŸ“š ØªØµÙØ­ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª
        </a>
        <a href="{% url 'exams:my_results' %}" class="btn btn-outline">
            ğŸ“Š Ù†ØªØ§Ø¦Ø¬ÙŠ
        </a>
    </div>

    <!-- My Courses -->
    <section>
        <h2>ğŸ“– Ù…Ø­Ø§Ø¶Ø±Ø§ØªÙŠ</h2>

        {% if enrollments %}
        <div class="courses-grid" style="margin-top: 20px;">
            {% for enrollment in enrollments %}
            <a href="{% url 'courses:lecture_detail' enrollment.lecture.id %}" class="card"
                style="text-decoration: none; padding: 0; overflow: hidden;">
                <div
                    style="position: relative; height: 150px; background: linear-gradient(135deg, var(--primary-blue), var(--primary-navy));">
                    <div style="position: absolute; top: 15px; left: 15px;">
                        {% if enrollment.is_completed %}
                        <span
                            style="background: var(--success); padding: 5px 10px; border-radius: 15px; font-size: 0.8rem;">âœ…
                            Ù…ÙƒØªÙ…Ù„</span>
                        {% else %}
                        <span
                            style="background: var(--accent-cyan); color: var(--primary-dark); padding: 5px 10px; border-radius: 15px; font-size: 0.8rem;">{{
                            enrollment.progress }}%</span>
                        {% endif %}
                    </div>
                    <div style="position: absolute; bottom: 15px; right: 15px; left: 15px;">
                        <h4 style="margin-bottom: 5px;">{{ enrollment.lecture.title }}</h4>
                        <p style="color: var(--text-muted); font-size: 0.9rem;">{{ enrollment.lecture.chapter.title }}
                        </p>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <div class="card" style="text-align: center; padding: 60px;">
            <span style="font-size: 3rem;">ğŸ“š</span>
            <h3 style="margin: 20px 0;">Ù„Ø³Ù‡ Ù…Ø§ Ø§Ø´ØªØ±ÙƒØªØ´ ÙÙŠ Ø£ÙŠ Ù…Ø­Ø§Ø¶Ø±Ø©</h3>
            <p style="color: var(--text-muted); margin-bottom: 20px;">ØªØµÙØ­ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙˆØ§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</p>
            <a href="{% url 'courses:chapter_list' %}?grade={{ user.grade }}" class="btn btn-primary">
                ØªØµÙØ­ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª âš¡
            </a>
        </div>
        {% endif %}
    </section>
</div>
{% endblock %}